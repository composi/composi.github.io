<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="description" content="Composi is a JavaScript library for creating component-based interfaces. It uses the virtual DOM to make efficient updates to the DOM based on a component's data or state.">
  <meta name="keywords" content="javascript, framework, performance, small, fast, UI, programming, code, component, composi, chocolatechipui, chocolatechip-ui, reactive, virtual dom">
  <title>Composi - Docs</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/prism.css">
</head>

<body class='page'>
  <nav>
    <ul class='nav-menu'>
      <li class='nav-menu__item'>
        <a class='nav-menu__item__link' href="/index.html">
          <svg id='composi-logo' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Composi Logo</title>
            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="Composi-Logo-Solid" fill="#fff">
                <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z"
                  id="Combined-Shape"></path>
              </g>
            </g>
          </svg>
          <span class='logo__link--text'>Composi</span></a>
      </li>
      <li class='nav-menu__item selected'>
        <a class='nav-menu__item__link' href="/en/docs/index.html">Docs</a>
      </li>
      <!--
      <li class='nav-menu__item'>
        <a class='nav-menu__item__link' href="/lessons/index.html">Lessons</a>
      </li>
      -->
    </ul>
  </nav>
  <article class='article'>
    <section>
      <div class='docs'>
        <h3>@composi/core</h3>
        <ul class='breadcrumb'><li><a href="/en/docs/core/install.html">Install</a></li>
        <li><a href="/en/docs/core/render.html">Render</a></li>
        <li><a href="/en/docs/core/props.html">Props</a></li>
        <li><a href="/en/docs/core/events.html">Events</a></li>
        <li><a href="/en/docs/core/lifecycle.html">Lifecycle</a></li>
        <li><a href="/en/docs/core/hydrate.html">Hydration</a></li>
        <li class='selected'>State</li>
        </ul>
        <h1>State</h1>
        <h2>State for Functional Components</h2>
        <p>Functional components are stateless. You pass data to them as a prop and that gets used during the render. This means that if you pass the same data to a functional component, it will render the exact same way each time. This makes rendering predictable and easier to troubleshoot.</p>

        <p>You can provide state management for functional components with @composi/datastore. If you've created a project with <a href="">@composi/create-composi-app</a>, you can import @composi/datastore into your project to use it.</p>
<pre><code class='language-bash'>import { h, render } from '@composi/core
import { DataStore } from '@composi/core'
</code></pre>


<p>After importing DataStore, you can create a dataStore. You do this by providing it some data. This will be an object literal with one property: <code>state</code>. Your data will be the value of the dataStore's state. The state can be a simple value or an array or object. You will then use the dataStore as the ultimate source of truth for the functional component's state. DataStores are reactive. They have an internal observer that watches for changes and then fires an event. You can define a watcher on the dataStore with an appropriately named event and have it re-render the functional component. Then, when you need to update state, you use the setState method on the dataStore to do so. This causes the watcher to react to the state changes and re-render the functional component. Job done.</p>

<pre><code class="language-javascript">// Create a new dataStore:
const dataStore = new DataStore({
  name: 'Joe'
})
// Create a watcher to react to changes in the dataStore's state:
dataStore.watch('update-occurred', () => {
  // Re-render the component when changes occur:
  render(<MyComponent data={dataStore.state}/>, 'section')
})
</code></pre>


    <p>Here is an example of a component whose state is managed by a dataStore:</p>

<p data-height="500" data-theme-id="6688" data-slug-hash="mzwmwy" data-default-tab="js,result" data-user="rbiggs"
  data-pen-title="@composi/core  with DataStore" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/mzwmwy/">@composi/core
    with DataStore</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

        <a name='debounce-renders'></a>
        <p>To learn more about how to use DataStore, read its <a href='/en/docs/datastore/install.html'>documentation</a>.</p>
    <h2>Debouncing Renders</h2>
    <p>If you've got something that produces a lot of data changes in rapid succesion, you may mind the rendering looking chopping. If that's the case you may want to debounce the render. You can do that with <code>requestAnimationFrame</code>:</p>
<pre><code class="language-javascript">dataStore.watch('anim-update', () => {
  requestAnimationFrame(() => {
    render(&lt;MyAnimation data={dataStore.state}/>, '#animationDiv')
  })
})
</code></pre>
      <p>Using <code>requestAnimationFrame</code> to control how often render occurs can help reduce jankiness when may changes are happening in rapid succesion. This means any type of event or action that can trigger many data updates. Below is an example of a dataStore producing many rapid updates by the movement of the mourse cursor or touch and using <code>requestAnimationFrame</code> to debounce the updates. Scroll down in the code to the Tree component and look for the <code>move</code> function to see how we debouce the render:</p>
      <p data-height="500" data-theme-id="6688" data-slug-hash="vVEWQa" data-default-tab="js,result" data-user="rbiggs"
        data-pen-title="@composi/core Pythagoras Dancing Tree" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/vVEWQa/">@composi/core
          Pythagoras Dancing Tree</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
      <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
        <p>&nbsp;</p>

      </div>
    </section>
  </article>
  <footer>
    <section>
      <svg id='composi-logo-footer' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>Composi Logo</title>
        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="Composi-Logo-Solid" fill="rgba(255,255,255,0.5)">
            <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z"
              id="Combined-Shape"></path>
          </g>
        </g>
      </svg>
      <h3>Composi is open source (MIT) and available on <a href='https://github.com/composi/core' target='__blank'>Github</a>
        and <a href="https://www.npmjs.com/package/@composi/core" target='__blank'>NPM</a>.</h3>
    </section>
  </footer>
  <script src="/js/prism.js"></script>
  
  
</body>

</html>